<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>üî• VERIFICA√á√ÉO - O QUE A API RETORNA</title>
    <style>
        * { font-family: monospace; }
        body { background: #1e1e1e; color: #00ff00; padding: 20px; margin: 0; }
        .container { background: #2d2d2d; padding: 20px; border-radius: 5px; max-width: 1200px; margin: auto; }
        h1 { color: #ffff00; }
        button { background: #00aa00; color: black; padding: 10px 15px; margin: 5px; cursor: pointer; font-weight: bold; border: none; border-radius: 3px; }
        button:hover { background: #00ff00; }
        pre { background: #0a0a0a; padding: 10px; border-radius: 3px; overflow-x: auto; max-height: 500px; overflow-y: auto; border-left: 3px solid #00ff00; }
        .success { border-left-color: #00ff00; }
        .error { border-left-color: #ff0000; }
        .section { margin: 20px 0; padding: 15px; background: #1a1a1a; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî• VERIFICA√á√ÉO - O QUE EXATAMENTE A API RETORNA</h1>
        
        <div class="section">
            <h2>Clique para ver os dados RAW da API (SEM processamento do JS)</h2>
            <button onclick="testarAPI()">üìä Testar COM valorOver=1</button>
            <pre id="resultado" class="success"></pre>
        </div>

        <div class="section">
            <h2>An√°lise dos Dados Retornados</h2>
            <pre id="analise"></pre>
        </div>
    </div>

    <script>
        async function testarAPI() {
            const payload = {
                time1: "Palmeiras",
                time2: "Santos",
                tipo: "gols",
                limite: 10,
                valorOver: "1"
            };

            console.log("üì§ Enviando para API:", payload);
            
            const response = await fetch('api/obter-historico-resultados.php', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const data = await response.json();
            console.log("üìä Resposta RAW da API:", data);

            // Mostrar dados RAW
            document.getElementById('resultado').textContent = JSON.stringify(data, null, 2);

            // An√°lise
            let analise = "";
            analise += "=== AN√ÅLISE DOS DADOS ===\n\n";
            
            analise += "1. FILTRO\n";
            analise += "   filtro_ativado: " + data.filtro_ativado + "\n";
            analise += "   filtro_valor_solicitado: " + data.filtro_valor_over_solicitado + "\n\n";

            analise += "2. QUANTIDADES\n";
            analise += "   total_time1: " + data.total_time1 + " resultados\n";
            analise += "   total_time2: " + data.total_time2 + " resultados\n";
            analise += "   TOTAL: " + (data.total_time1 + data.total_time2) + "\n\n";

            analise += "3. CONTE√öDO TIME1 (" + data.total_time1 + "):\n";
            if (data.time1_historico) {
                data.time1_historico.forEach((r, i) => {
                    analise += "   " + (i+1) + ". titulo: '" + r.titulo + "'\n";
                    analise += "      valor_over: " + r.valor_over + "\n";
                });
            }

            analise += "\n4. CONTE√öDO TIME2 (" + data.total_time2 + "):\n";
            if (data.time2_historico) {
                data.time2_historico.forEach((r, i) => {
                    analise += "   " + (i+1) + ". titulo: '" + r.titulo + "'\n";
                    analise += "      valor_over: " + r.valor_over + "\n";
                });
            }

            analise += "\n5. VERIFICA√á√ÉO\n";
            let todosCorretos = true;
            const esperado = "1";
            
            // Verificar TIME1
            if (data.time1_historico) {
                data.time1_historico.forEach((r, i) => {
                    const match = r.titulo.includes("+1");
                    analise += "   TIME1[" + i + "]: " + (match ? "‚úÖ" : "‚ùå") + " (esperado +1, encontrado: " + r.titulo + ")\n";
                    if (!match) todosCorretos = false;
                });
            }

            // Verificar TIME2
            if (data.time2_historico) {
                data.time2_historico.forEach((r, i) => {
                    const match = r.titulo.includes("+1");
                    analise += "   TIME2[" + i + "]: " + (match ? "‚úÖ" : "‚ùå") + " (esperado +1, encontrado: " + r.titulo + ")\n";
                    if (!match) todosCorretos = false;
                });
            }

            analise += "\n6. RESULTADO FINAL\n";
            if (todosCorretos && (data.total_time1 + data.total_time2) > 0) {
                analise += "   ‚úÖ API EST√Å RETORNANDO DADOS CORRETOS!\n";
                analise += "   Todos os resultados cont√™m +1\n";
            } else if ((data.total_time1 + data.total_time2) === 0) {
                analise += "   ‚ùå API retornou 0 resultados\n";
            } else {
                analise += "   ‚ùå API retornou dados MISTURADOS (cont√©m +0.5 ou outros OVERS)\n";
            }

            document.getElementById('analise').textContent = analise;
        }
    </script>
</body>
</html>
